{
  "scripts": [
    {
      "description": "Variable Recurring Payments consents is AwaitingAuthorisation",
      "id": "OB-301-VRP-100100",
      "refURI": "https://openbankinguk.github.io/read-write-api-site3/v3.1.8/resources-and-data-models/vrp/domestic-vrp-consents.html",
      "detail": "Check Domestic Variable Recurring Payment consents returns in AwaitingAuthorisation.",
      "parameters": {
        "tokenRequestScope": "payments",
        "instructedAmountCurrency": "$instructedAmountCurrency",
        "instructedAmountValue": "$instructedAmountValue",
        "OB-301-VRP-100100-instructionIdentification": "$instructionIdentification",
        "instructionIdentification": "$fn:instructionIdentificationID()",
        "endToEndIdentification": "e2e-domestic-pay",
        "postData": "$minimalDomesticVRPConsent",
        "requestConsent": "true"
      },
      "headers": {
        "Content-Type": "application/json"
      },
      "body": "$postData",
      "uri": "/domestic-vrp-consents",
      "uriImplementation": "mandatory",
      "resource": "DomesticVRP",
      "asserts": [
        "OB3GLOAssertOn201",
        "OB3GLOFAPIHeader",
        "OB3DOPAssertAwaitingAuthorisation",
        "OB3GLOAAssertConsentId"
      ],
      "keepContextOnSuccess": {
        "name": "OB-301-VRP-100100-ConsentId",
        "value": "Data.ConsentId"
      },
      "method": "post",
      "schemaCheck": true,
      "validateSignature": false
    },       
    {
      "description": "Domestic Variable Recurring Payment for processing succeeds with minimal data.",
      "id": "OB-301-VRP-100600",
      "refURI": "https://openbankinguk.github.io/read-write-api-site3/v3.1.8/resources-and-data-models/vrp/domestic-vrps.html",
      "detail": "Check that once the domestic-payment-consent has been authorised by the PSU, the PISP can proceed to submitting the domestic-payment for processing.",
      "parameters": {
        "tokenRequestScope": "payments",
        "consentId": "$OB-301-VRP-100100-ConsentId",
        "thisSchemeName": "$creditorScheme",
        "thisIdentification": "$creditorIdentification",
        "instructionIdentification": "$OB-301-VRP-100100-instructionIdentification",
        "endToEndIdentification": "e2e-domestic-pay",
        "instructedAmountCurrency": "$instructedAmountCurrency",
        "instructedAmountValue": "$instructedAmountValue",
        "postData": "$minimalDomesticVRP"
      },
      "headers": {
        "Content-Type": "application/json"
      },
      "body": "$postData",
      "uri": "/domestic-vrps",
      "uriImplementation": "mandatory",
      "resource": "DomesticVRP",
      "asserts": [
        "OB3GLOAssertOn201"
      ],
      "keepContextOnSuccess": {
        "name": "OB-301-VRP-100600-DomesticVRPId",
        "value": "Data.DomesticVRPId"
      },
      "method": "post",
      "schemaCheck": true,
      "validateSignature": false
    }
  ]
}